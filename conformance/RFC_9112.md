# 2.2 Message Parsing

| TC    | Description |
| :---  | :---        |
| 1     | A recipient MUST parse an HTTP message encoding ~US-ASCII |
| 2     | A recipient of such a bare CR MUST consider that element to be invalid |
| 3     | An HTTP/1.1 user agent MUST NOT preface or follow a request with an extra CRLF |
| 4     | SHOULD ignore at least one empty line (CRLF) received prior to the request-line |
| 5     | A sender MUST NOT send whitespace between the start-line and the first header field. |
| 6     | A recipient with SP between the start-line and the first header field MUST reject as invalid |
| 7     | server SHOULD respond with a 400 (Bad Request) response and close the connection. |

# 2.5. Protocol Version

| TC   | Description             |
| :--- | :---                    |
| 1    | HTTP/1 implies HTTP/1.0 |

# 3 Request Line

| TC   | Description |
| :--- | :---        |
| 1    | strict parsing with single SP separator         |
| 2    | method too long: 501 (Not Implemented)          |
| 3    | request-target too long: 414 (URI Too Long)     |
| 4    | RECOMMENDED request-line lengths of 8000 octets |

# 3.2 Request Target

| TC   | Description |
| :--- | :---        |
| 1    | invalid request-line: 400 (Bad Request)     |
| 2    | A client MUST send a Host header            |
| 3    | target URI authority must match Host header |
| 4    | Host header lacking: 400 (Bad Request)      |
| 5    | .. or multiple Host headers                 |
| 6    | .. or invalid host value                    |

# 3.2.1 origin-form

| TC   | Hook | Description |
| :--- | :--- | :---        |
| 1    |      | Only absolute path |
| 2    |      | Empty path /       |

# 3.2.2 asterisk-form

| TC   | Hook | Description             |
| :--- | :--- | :---                    |
| 1    |      | Allowed  with OPTIONS * |

# 5.1 Field Line Parsing

| TC   | Hook | Description                               |
| :--- | :--- | :---                                      |
| 1    |      | Field name - No SP before colon `:`: 400 (Bad Request) |
| 2    |      | Value may be preceded and/or followed by OWS  |
| 3    |      | Value OWS is excluded as forwarded downstream | 

# 5.2 Obsolete Line Folding

| TC   | Hook | Description                               |
| :--- | :--- | :---                                      |
| 1    |      | obs-fold: 400 (Bad Request)               |

# 6 Message Body

| TC   | Hook | Description                               |
| :--- | :--- | :---                                      |
| 1    |      | Content-Length based                      |

# 6.1 Transfer-Encoding

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | Transfer-encoding: chunked                |
| 2    |       | 501 (Not Implemented)                     |
| 3    | 6.1.3 | 1xx & 204 - No header                     |
| 4    |       | >= HTTP/1.1 Only                          |
| 5    | 6.1.5 | Reject Content-Length and Transfer-Encoding |
| 6    | 6.1.6 | Close connection when both headers present |
| 7    |       | Reject HTTP/1.0 Transfer-Encoding          |

# 6.2 Content-Length

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
|      | 6.2.1 | No Content-Length AND Transfer-Encoding   |

# 6.3. Message Body Length

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | HEAD Resp & 1xx, 204, 304 - No body.      |
| 2    |       | Response: Transfer-encoding: - until EOF  |
| 3    |       | Request: Transfer-encoding: - 400 (Bad Request) |
| 4    |       | Neither Content-length / TE: 400 (Bad Request) |
| 5    |       | Observe incomplete body                   |
| 6    |       | close-delimiting feature                  |
| 7    |       | 411 (Length Required)                     |

# 7. Transfer Codings

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | Case insensitivity   |

# 7.1. Chunked Transfer Coding

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | Parsing and encoding                      |
| 2    |       | does not define any parameters            |

# 7.1.1. Chunk Extensions

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | limits: 4xx (Client Error)                |
| 2    |       | ignore unrecognized chunk extensions      |

# 7.1.2. Chunked Trailer Section

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | discard the received trailer fields       |

# 7.2. Transfer Codings for Compression

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | Parameters: Bad request                   |

# 7.4. Negotiating Transfer Codings

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | Ranked TE                                 |
| 2    |       | No chunked in Transfer coding             |
| 3    |       | q is case-insensitive                     |
| 4    |       | q=0 not acceptable                        |
| 5    |       | Not present, without acceptable           |
|      | 7.4.1 | TE present in Connection                  |

# 8. Handling Incomplete Messages

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | Timed out incomplete                      |
| 2    |       | Chunked encoding fails incomplete         |
| 3    |       | Content-length incomplete                 |

# 9.3. Persistence

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | persistent connection                     |
| 2    |       | Connection: Close (by server)             |
| 3    |       | Connection: Close (by client intent)      |
| 4    |       | HTTP/1.0 Keep-Alive                       |

# 9.3.2. Pipelining

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | FIFO req in, resp out ordered             |

# 9.4. Concurrency

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | Limiter API                               |

# 9.5. Failures and Timeouts

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | graceful close on the connection upon timeout |

# 9.6. Tear-down

| TC   | Hook  | Description                               |
| :--- | :---  | :---                                      |
| 1    |       | Client Post Close must close              |
| 2    |       | Server post Close must close              |
| 3    |       | Close must be present upon close          |


[mdn]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Methods/OPTIONS
[iana]: https://www.iana.org/assignments/http-parameters/http-parameters.xhtml
[http10]: https://httpwg.org/specs/rfc9112.html#compatibility.with.http.1.0.persistent.connections
[iana-http-fields]: https://www.iana.org/assignments/http-fields
[iana-media-types]: https://www.iana.org/assignments/media-types
